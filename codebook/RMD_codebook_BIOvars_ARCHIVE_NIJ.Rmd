---
title: "Biological Assessment Codebook"
author: ""
date: ""
output:
  html_document:
    toc: true
    toc_depth: 4
    toc_float: true
    self_contained: true
    number_sections: false
  pagedown::html_pretty:
    toc: true
    toc_depth: '4'
bibliography: tpw_references.bib
editor_options:
  markdown:
    wrap: 72
---
<!-- TOC highlight color -->
<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #246B69;
}


<!-- To have nice indentation in toc float -->
.tocify-header {
  text-indent: initial;
}

.tocify-subheader > .tocify-item {
  text-indent: initial;
  padding-left: 2em;
}

/* Third-level header */
.tocify-subheader .tocify-subheader > .tocify-item {
  text-indent: initial;
  padding-left: 4em; /* Adjust the padding as needed */
}

/* Fourth-level header */
.tocify-subheader .tocify-subheader .tocify-subheader > .tocify-item {
  text-indent: initial;
  padding-left: 6em; /* Adjust the padding as needed */
}

</style>

```{r setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

if (!require("pacman")) install.packages("pacman")

pacman::p_load(readxl, here, tidyverse, openxlsx, gt, tidyverse, scales, ggpubr)

```

```{r import, include = FALSE}
#Import DBS file
#file path
dbs_fp <- here("do_not_push", "dbs_archive.xlsx")

#import data from all tabs
dbs_cho_df <- read_excel(dbs_fp, sheet = "CHO") 

dbs_hdl_df <- read_excel(dbs_fp, sheet = "HDL") 

dbs_trg_df <- read_excel(dbs_fp, sheet = "TRG")

dbs_crp_df <- read_excel(dbs_fp, sheet = "CRP")

dbs_ebv_df <- read_excel(dbs_fp, sheet = "EBV")

dbs_a1c_df <- read_excel(dbs_fp, sheet = "A1c")

dbs_il6_df <- read_excel(dbs_fp, sheet = "IL6")

#import BIO assessment file
bio_df <- read_excel(here("do_not_push", "bio_archive.xlsx"))
#import meta data for variable tables
bio_md <- read_excel(here("codebook", "bio_metadata_archive.xlsx")) %>% 
  rename(Variable = DATA,
         Description = `Variable description`) %>%
  filter(!str_ends(Variable, "pal")) %>%
  filter(!str_ends(Variable, "cal"))

```

```{r DELETE}
#COPIED FROM CODEBOOK SO THIS WILL RENDER WITH SAME FORMAT/THEME - DELETE WHEN INTEGRATING INTO FULL CODEBOOK
source(here("functions", "codebook_fun.R"))

# Color palettes 
 Two_color = c("#246B69", "#604C41")

# Histogram style 
# hist_style <- geom_histogram(bins=20, color = "white", fill = "#246B69", alpha = 0.7)


bar_style <- geom_bar(color = "white", fill = "#246B69", alpha = 0.7)

THEME <-     theme(panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          panel.background = element_rect(fill = "transparent"),
          panel.border = element_blank(),
          axis.line = element_line(colour = "black",size = .8),
          axis.text = element_text(size = 10), axis.title = element_text(size = 10),
          legend.text = element_text(size = 10),legend.key = element_rect(fill = "White", colour = "transparent"),plot.title = element_text(size= 13),
    )

#re-work JP cutoff function due to error "cant use `{{` in non-quoting function
cutoff_plot2 <- function(data,
                        x,
                        cutoff = 0,
                        cutoff_color = '#324B4A',
                        cutoff_other = NULL,
                        cutoff_other_color = '#95B1AF',
                        cutoff_other2 = NULL,
                        cutoff_other2_color = '#546085',
                        bins = 20) {

  library(magrittr)
  library(dplyr)
  library(ggplot2)

  x <- enquo(x)

  if (is.null(cutoff_other)) {
    data %>%
      ggplot(aes(!!x)) +
      geom_histogram(bins = bins,
                     color = 'white',
                     fill = '#246B69',
                     alpha = .7) +
      geom_vline(xintercept = cutoff,
                 color = cutoff_color,
                 linetype = 2,
                 linewidth = 1.25)+
    theme(panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          panel.background = element_rect(fill = "transparent"),
          panel.border = element_blank(),
          axis.line = element_line(colour = "black",size = .8),
          axis.text = element_text(size = 10), axis.title = element_text(size = 10),
          legend.text = element_text(size = 10),
          legend.key = element_rect(fill = "White",
                                    colour = "transparent"),
          plot.title = element_text(size= 20),
          #scale_x_discrete(guide = guide_axis(n.dodge=3))
    )
  } else if (is.null(cutoff_other2)) {
    data %>%
      ggplot(aes(!!x)) +
      geom_histogram(bins = bins,
                     color = 'white',
                     fill = '#246B69',
                     alpha = .7) +
      geom_vline(xintercept = cutoff,
                 color = cutoff_color,
                 linetype = 2,
                 linewidth = 1.25) +
      geom_vline(xintercept = cutoff_other,
                 color = cutoff_other_color,
                 linetype = 3,
                 linewidth = 1.25)+
    theme(panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          panel.background = element_rect(fill = "transparent"),
          panel.border = element_blank(),
          axis.line = element_line(colour = "black",size = .8),
          axis.text = element_text(size = 10), axis.title = element_text(size = 10),
          legend.text = element_text(size = 10),
          legend.key = element_rect(fill = "White",
                                    colour = "transparent"),
          plot.title = element_text(size= 13),
          #scale_x_discrete(guide = guide_axis(n.dodge=3))
    )
  } else {
    data %>%
      ggplot(aes(!!x)) +
      geom_histogram(bins = bins,
                     color = 'white',
                     fill = 'black',
                     alpha = .7) +
      geom_vline(xintercept = cutoff,
                 color = cutoff_color,
                 linetype = 2,
                 linewidth = 1.25) +
      geom_vline(xintercept = cutoff_other,
                 color = cutoff_other_color,
                 linetype = 3,
                 linewidth = 1.25) +
      geom_vline(xintercept = cutoff_other2,
                 color = cutoff_other2_color,
                 linetype = 4,
                 linewidth = 1.25)+
    theme(panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          panel.background = element_rect(fill = "transparent"),
          panel.border = element_blank(),
          axis.line = element_line(colour = "black",size = .8),
          axis.text = element_text(size = 10), axis.title = element_text(size = 10),
          legend.text = element_text(size = 10),
          legend.key = element_rect(fill = "White",
                                    colour = "transparent"),
          plot.title = element_text(size= 13),
          #scale_x_discrete(guide = guide_axis(n.dodge=3))
    )
  }
}

# gt-theme-general
apply_tbl_theme <- function(table) {
  table %>% 
  tab_style(style = list(cell_borders(sides = "all", color = "black", weight = px(1))),
            locations = cells_body(columns = everything())) %>% 
  tab_style(style = list(cell_borders(sides = "all", color = "black", weight = px(1)),
                         cell_fill(color = "#246B69", alpha = .7)),
            locations = cells_column_labels()) %>% 
  tab_options(column_labels.border.top.color = "black",
              column_labels.border.bottom.color = "black",
              table_body.border.bottom.color = "black",
              table.border.top.color = "white",
              heading.border.bottom.color = "black",
              table_body.hlines.color = "white")%>% 
  tab_options(table.align = "left")
}

#theme for value label tables
apply_labtab_theme <- function(table) {
  table %>% 
  cols_align(columns = everything(), align = "center") %>% 
  tab_style(style = list(cell_borders(sides = "all", color = "black", weight = px(1))),
            locations = cells_body(columns = everything())) %>% 
  tab_style(style = list(cell_borders(sides = "all", color = "black", weight = px(1)),
                         cell_fill(color = "#246B69", alpha = .7)),
            locations = cells_column_labels()) %>% 
  tab_options(column_labels.border.top.color = "black",
              column_labels.border.bottom.color = "black",
              table_body.border.bottom.color = "black",
              table.border.top.color = "white",
              heading.border.bottom.color = "black",
              table_body.hlines.color = "white") %>% 
  tab_options(table.align = "left")
}

```

```{r bio-functions-KEEP}
#custom functions for bio codebook
#create function for calculating continuous summary statistics
calc_cont_sum_stats <- function(df) {
  stats_list <- lapply(names(df), function(name) {
    x <- df[[name]]
    mean_val <- sprintf("%.2f", round(mean(x, na.rm = TRUE), 2))
    sd_val <- round(sd(x, na.rm = TRUE), 2)
    range_val <- paste(round(min(x, na.rm = TRUE), 2),
                       round(max(x, na.rm = TRUE), 2), sep = "-")
    miss_val <- round(mean(is.na(x)) * 100, 2)
    data.frame(Variable = name, Mean = mean_val, SD = sd_val, Range = range_val, Missing = paste(miss_val, "%", sep = ""))
  })
  stats_df <- do.call(rbind, stats_list)
  return(stats_df)
}

#create function for calculating dichotomous summary statistics
calc_dichot_sum_stats <- function(df) {
  stats_list <- lapply(names(df), function(name) {
    x <- df[[name]]
    per_no <- paste0(round(sum(x == 0, na.rm = TRUE) / length(x) *100, 1), "%")
    per_yes <- paste0(round(sum(x == 1, na.rm = TRUE) / length(x) *100, 1), "%")
    num_no <- sum(x == 0, na.rm = TRUE)
    num_yes <-sum(x == 1, na.rm = TRUE)
    miss_val <- round(mean(is.na(x)) * 100, 2)
    data.frame(Variable = name, per_no = per_no, per_yes = per_yes, num_no = num_no, num_yes = num_yes, Missing = paste(miss_val, "%", sep = ""))
  })
  stats_df <- do.call(rbind, stats_list)
  return(stats_df)
}

#create function to create plot for AL indicators
create_AL_plot <- function(data, column_name, composite_name) {
  transform_AL_plot <- function(x) {
    factor(x, levels = c("0", "1", "-99"), labels = c("No", "Yes", "Missing"))
  }
  if (!is.character(column_name) || !column_name %in% names(data)) {
    stop("column_name must be a character string and exist in the dataframe.")
  }
  data %>%
    mutate("{column_name}" := transform_AL_plot(.[[column_name]])) %>%
    ggplot(aes_string(x = column_name)) +
    bar_style +
    labs(x = "Response", y = "Count", title = paste("Distribution for", composite_name)) +
    THEME
}

#create function to process columns with multiple responses
calc_multi_column <- function(column, responses) {
  responses_list <- strsplit(as.character(column), ";")
  flat_responses <- unlist(responses_list)
  flat_responses <- trimws(flat_responses)  

  valid_responses <- flat_responses[flat_responses %in% c(responses, "-55")]

  count_response <- function(response) {
    sum(valid_responses == response, na.rm = TRUE)
  }

  total_valid_responses <- length(valid_responses)

  response_counts <- sapply(c(responses, "-55"), count_response)
  response_percents <- round(response_counts / total_valid_responses * 100, 1)

  data.frame(
    Response = c(responses, "-55"),
    Count = response_counts,
    Percent = response_percents,
    stringsAsFactors = FALSE
  )
}

#create function for all bio vars in bio data
create_bio_var_tbl <- function(data, prefix) {
  filtered_data <- data %>%
    filter(str_starts(Variable, prefix))

  var_table <- filtered_data %>%
    gt() %>%
    cols_width(
      Variable ~ pct(25),
      Description ~ pct(75)) %>%
    apply_tbl_theme() %>%
    tab_style(
      style = cell_text(align = "left"), 
      locations = cells_column_labels())

  return(var_table)
}

#create function to make dichotomous table
create_dichot_gt_table <- function(data) {
  table <- data %>%
    gt() %>%
    cols_label(num_no = "N",
               per_no = "%",
               num_yes = "N",
               per_yes = "%",
               Missing = "% Missing") %>%
    tab_options(table.width = pct(100)) %>%
    cols_align(columns = c(per_no, per_yes, num_no, num_yes, Missing), align = "center") %>%
    tab_spanner(label = "No", columns = c(num_no, per_no)) %>%
    tab_spanner(label = "Yes", columns = c(num_yes, per_yes)) %>%
    tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(num_yes, num_no, per_yes, per_no)))
  
  return(table)
}




```
# Overview

## Longitudinal Study Background  

This study is a longitudinal extension which aims to further our understanding of trajectories of adult offending in a sample of 158 (n = 8 participants are now deceased) women who participated in a randomized intervention trial aimed at reducing conduct problems and delinquency during adolescence. The study was originally supported and funded through the Oregon Youth Authority and by Grant R01 DA015208 (P.I., Patricia Chamberlain, Ph.D.) from the National Institute on Drug Abuse, and by Grant R01 MH054257 (P.I., Patricia Chamberlain, Ph.D.) from the National Institute of Mental Health. In the original study, juvenile justice involved girls ages 13 – 17 who had been referred for out-of-home placement due to chronic delinquency were randomly assigned to participate in services as usual (group care; GC) or in Treatment Foster Care Oregon (TFCO, Chamberlain, 2003). The first extension of this longitudinal study was funded by Grant R01 DA024672 (P.I., Leslie Leve, Ph.D.). That study examined the developmental pathways of risk for juvenile justice involved girls into young adulthood with the original participants who were at the time, ages 16-29 years.


## Study Goals 

-   **Goal 1** Explore the constellation of risk factors and risk processes in the lives of adult women with histories in the juvenile justice system 

-   **Goal 2** Identify potential turning points across adulthood in the lives of adult women with histories in the juvenile justice system. 

-   **Goal 3** Understand how justice involvement is related to women's health outcomes, including biological indicators of health and stress.

-   **Goal 4** Examine the potential long-term impact of Treatment Foster Care Oregon, a gender-specific intervention. 



### Data and Study Author Contact

If you have questions about the data or study, please contact the Principal Investigator, Maria Schweer-Collins (mariasc@iastate.edu) and please use the subject "NACJD Turning Points Data Query" in the subject line.

### Credit Author Statement

This codebook was created by a team of individuals who contributed throughout different phases of the project, including Dr. Shaina Trevino, Min Zhang, and Dr. Jonathan Pedroza, together with PI Maria Schweer-Collins.

**Schweer-Collins** conceptualization; software; validation; data curation (specifically checking code for data cleaning and codebook creation, managed data archival) project administration; supervision; funding acquisition; **Trevino** software; validation; data curation (specifically developing codebook, functions, and protocols, data cleaning, codebook creation; data archival); supervision; **Pedroza** software; data curation (specifically making functions used in codebook, data retrieval from Qualtrics; cleaning; codebook creation, visualization); **Zhang** software; validation; data curation (specifically making functions used in codebook, primary responsibility for data retrieval from Qualtrics; data cleaning, codebook creation, visualization)

## Data Collection Activities in this Wave  

There were two assessment activities. 

**Telephone Interview**

-   First, one telephone interview was conducted with original participants (*M* = 18 years after each participant's baseline assessment). This interview lasted approximately 2 hours and included an assessment of the following constructs: parenting, partner characteristics, health-risking behaviors, mental health and trauma/victimization experiences, and public system involvement. 
-   In this assessment wave, we consented 133 participants of the 158 original participants who are living (84% retention). Of those, 130 participants completed the telephone portion of the assessment. Additionally, we were able to partner with the state department of corrections and interview all participants who were currently incarcerated in prison systems (*n* = 4).

**Biological Assessment**

-   The second part of the assessment was a 1 hour biological and physical health assessment. While prior waves collected limited information on self-reported health, this longitudinal extension also included a more robust battery of health conditions and a robust battery of 12 biomarkers, used to assess allostatic load, including cardiovascular, metabolic, and immune system function. This biological assessment was conducted either in person or virtually due to COVID-19 restrictions. 
-   123 participants completed the biological assessment. Two of the four participants who were incarcerated also completed a small portion of the *self-report* (not biological) measures from the biological assessment, thus our total analytic file for the biological assessment is *n* = 125.  


  

## Data and Codebook Guide


### Introduction to Codebook Structure

This document is a codebook specifically for the **biological assessment**. There is a separate codebook for data obtained in the telephone assessment. This document provides a summary of each measure assessed in the Turning Points for Women Study. Most of the measures described here have actual or potential computed scale scores. Some measures, however, are simply collections of individual items (e.g., demographic variables). We have tried to use the official name of each measure as the heading for each section; many measures, however, do not have official names and therefore the chosen name is arbitrary. If you cannot find a study measure in the table of contents, you may want to search for a keyword in this document.

For each measure, this document typically contains the following descriptive information:

-   A brief description of what the instrument measures  

-   Pertinent references  

-   All measures were collected from the original study participant unless otherwise indicated  

-   Variable name, variable description, and notes about the variable, for example, if a variable should be reverse scored or if a variable was not administered to participants who were incarcerated at the time of the assessment   

-   Description of how missing data is coded and handled in scale scores. Generally, this information is covered in the introductory materials as missing codes are consistent across *all* study variables, but if exceptions apply, they will be noted in the cleaning script and this codebook.  

-   Formulas for creating scale scores and the resulting variables  

-   Coefficient alphas of scales or subscale scores and notes about their distribution and valid ranges of the data  


### Missing Data

-   Truly missing = `NA` (blank in file or -99): The question should
    have been asked of the respondent, but for a reason other than those
    listed below, no answer was given or recorded.

    This -99 is also given in the case of a computed subscale or total
    score or other summary when the percentage of missing data is
    outside what is allowable for missing data rules

-   Not Applicable = -55: The subject was never asked a question for
    some reason (most often conditional question [skip rules])

-   Don't Know = -66: The subject was unable to answer a question,
    either because he or she had no opinion or because the required
    information was not available (could not recall).

-   Refusal/No Answer = -77: The subject explicitly refused to answer a
    question or did not answer it when he or she should have.

-   Processing Error = -44: For some reason, there is no answer to the
    question, although the subject provided one. This can result from
    interviewer error, incorrect coding, machine failure, or other
    problems. This code does not exist in our data.
    
-   **Important Note:** Data users should ensure that missing data values (all negative numbers in this dataset) are not being analyzed as valid numeric values prior to analyzing any data in the files associated with this study.

### Missing Data Rule

For summary or subscale scores that are computed with individual items, any of the above reasons are included in computing the percent of missing data. The following missing data rules are below and follow procedures used throughout the history of this longitudinal study. In some cases, measure specific guidelines for handling missing data were used when those guidelines were more stringent. Exceptions are called out within individual measure documentation.

Note that we have made every effort to archive individual-level items so that users of the data can compute summary scores and complete analyses using a variety of modern missing data methods (e.g., imputation).  

-   For scales with [10 or more items]{.underline}, a composite score
    (average/total) is computed for each participant that has less than
    [20%]{.underline} of the items from that measure missing

-   For scales with [7 to 9 items]{.underline}, a composite score
    (average/total) is computed for each participant that has less than
    [30%]{.underline} of the items from that measure missing

-   For scales with [3 to 6 items]{.underline}, a composite score
    (average/total) is computed for each participant that has less than
    [33%]{.underline} of the items from that measure missing

-   For scales with [only 2 items]{.underline}, composite scores
    (average/total) are calculated on a [case by case basis]{.underline}

### Data Use Notes and Disclaimers

Because the use of and development of measures is ever evolving and there exist many ways to analyze data, we have made every effort to archive individual-level items so that users of the data can compute summary scores according to preferred methods, latest empirical findings, and recommended best practices, including best practices for handling missing data. Users are also encouraged to thoroughly read the data documentation and perform data checks for outliers, out-of-range values, and to determine if any cases should be excluded from analyses based on checks with relevant criteria for research questions or analyses of interest. Users are encouraged to query the study author if questions arise.

### Study Acronyms

```{r abbreviation_table, results = 'asis'}

abbrev_table_df <- data.frame(
  abbrev = c("TP", "Wave 14", "TC", "NIJ", "CINT"),
  descrip = c(
    "This acronym is used to refer to the name of this study, the Turning Points Study for Women. References in this codebook and in subsequent publications regarding the Turning Points study may or may not include data only from this assessment or data that also draw on the prior 13 waves of data, as we use this study name to refer to the entire longitudinal study.",
    "We refer to this wave of data collection also as 'Wave 14' thus, you may see variables that include this notation in the naming convention.",
    "In this study, we refer to original participants as TCs, which means 'Target Child.' This acronym has been continued because the original participants were minors at the start of this longitudinal study. Please note that we have continued to use this acronym to distinguish our original sample from other participants (e.g., partners of original participants, the offspring of original participants). The data represented in this codebook were collected only from original participants, not from partners, caregivers, or offspring.",
    "NIJ is the acronym for the National Institute of Justice. NIJ funded this study and therefore the organization is referred to throughout our documentation and forthcoming publications and presentations.",
    "CINT is our study name for 'Child Interview' and refers to an assessor administered interview that has been delivered to our participants at each wave of the longitudinal study, with some slight variation according to developmental stage and the focus of each assessment. This CINT interview includes information about demographics, substance use, and relationship variables. "
  ),
  stringsAsFactors = FALSE
)

#create table
abbrev_table <- abbrev_table_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(abbrev ~ px(100),
             descrip ~ px(600)) %>%
  tab_style(style = cell_text(align = "left"),locations = cells_body(columns = vars("descrip"))) %>%
 # cols_align(align = "left") %>%
  cols_label(abbrev = "Abbreviation",
            descrip = "Full Name and Explanation") %>%
  apply_labtab_theme()


# Print the table
print(abbrev_table)

```

# Dried Blood Spot Data

These data are in the `dbs_archive_NIJ.csv` file.

-   The seven biological constructs assessed through dried blood spots were cholesterol, high-density lipoprotein cholesterol, Triglycerides, c-reactive protein, Epstein-Barr virus, hemoglobin A1C, and Interleukin-6.. 

-   For each biological construct, allostatic load indicators can be computed using different methods including clinical cutoffs developed and published in the literature, or percentile based scores. Users of the data should explore recent literature to identify best practices, which are always evolving, when analyzing these data. Additionally, please note that users should identify potential outliers or out of range values. For the purposes of transparency, all raw data are archived and users of the data must do these basic data checks. See reference below from the MacArthur Studies of Successful Aging for guidance on using the 13 allostatic load indicators in this file to compute an allostatic load index using either clinical or percentile based scoring methods.  

-   Please see documentation called "Description of Assays for Dried Blood Spots...pdf" when writing up procedures used to obtain values provided in the associated `dbs_archive_NIJ.csv` datafile.

Reference:[@seeman2001social](https://psycnet.apa.org/fulltext/2001-11106-001.pdf)


### Cholesterol (CHO) Description

These data include variables related to the cholesterol assessment, including direct and plasma equivalent (PE) cholesterol values for participants. Higher values indicate higher cholesterol. The PE cholesterol value should be used to compute an allostatic load indicator.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

CHO is measured in mg/dL.



#### Value Labels

The value labels for all `_note` variables (`cho_punch_note`, `cho_assay_note`, and `cho_result_note`) are below: 

```{r CHO-label-table, results = 'asis'}

cho_label_df <- data.frame(
  value = c("1", "4", "5", "37", "42"),
  label = c("Blank punch",
            "Small spot, <80%",
            "Non-circular dried blood spot",
            "Punch did not elute",
            "Blood from filter paper touched inside back cover")
) %>% 
  t() %>% 
  as.data.frame()

cho_label_df <- setNames(cho_label_df[-1, ], unlist(cho_label_df[1, ]))


#create table
cho_label_table <- cho_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(cho_label_table)

```
```{r CHO-dichot-value, results = 'asis'}
#create dichotomous table to be re-used
dichot_label_df <- data.frame(
  value = c("0", "1"),
  label = c("No",
            "Yes")
) %>% 
  t() %>% 
  as.data.frame()

dichot_label_df <- setNames(dichot_label_df[-1, ], unlist(dichot_label_df[1, ]))


#create table
dichot_label_table <- dichot_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()
```


#### Variables

All CHO variables are presented in the following table.

```{r CHO-var-table, results = 'asis'}
#create table of info
cho_var_df <- data.frame(
  Variable = c("dbs_id", "family", "cho_direct", "cho_pe", "cho_punch_note", "cho_assay_note", "cho_result_note", 
            "cho_plate", "cho_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct cholesterol analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent cholesterol analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
cho_var_table <- cho_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(cho_var_table)

```

#### Descriptive Statistics

Descriptive statistics are presented below for key CHO variables.

**Raw cholesterol values:** 

```{r cho-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
cho_sum_df <- dbs_cho_df %>% 
  select(cho_direct, cho_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats()

#create gt table
cho_sum_tbl <- cho_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
cho_sum_tbl

```


**Data collection notes:** 

```{r cho-cat-summary-table, results = 'asis'}
#notes for cho_df
cho_notes <- c(1, 4, 5, 37, 42)

cho_note_df <- dbs_cho_df %>% 
  select(ends_with("note"))

#apply function to each note column
cho_note_list <- lapply(cho_note_df, function(column) calc_multi_column(column, cho_notes))

#combine results into df
cho_note_sum <- bind_rows(cho_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
cho_tbl_notes <- cho_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_4 = "N",
             Count_5 = "N",
             Count_37 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_37 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100))%>%
  cols_align(columns = c("Count_1", "Count_4", "Count_5", "Count_37", "Count_42", "Percent_1",
                         "Percent_4", "Percent_5", "Percent_37", "Percent_42", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Did not elute", columns = c(Count_37, Percent_37)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_4, Percent_4,
                                                        Count_5, Percent_5, Count_37, Percent_37,
                                                        Count_42, Percent_42))) 

# Render the table
print(cho_tbl_notes) 



```


### High-Density Lipoprotein Cholesterol (HDL) Description

These data include variables related to the HDL cholesterol assessment, including direct and plasma equivalent (PE) HDL cholesterol values for participants. Higher values indicate higher HDL cholesterol. However, it should be noted that lower values of HDL are considered poorer in terms of allostatic load, thus if percentile based scores are used, the bottom quartile should be considered as an indicator of greater allostatic load. The PE value should be used to calculate allostatic load indicators.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

HDL is measured in mg/dL.

#### Value Labels

The value labels for all `_note` variables (`hdl_punch_note`, `hdl_assay_note`, and `hdl_result_note`) are below: 

```{r hdl-label-table, results = 'asis'}
#same notes as cho vars
# Print the table
print(cho_label_table)

```


#### Variables

All HDL variables are presented in the following table.

```{r hdl-var-table, results = 'asis'}
#create table of info
hdl_var_df <- data.frame(
  Variable = c("dbs_id", "family", "hdl_direct", "hdl_pe", "hdl_punch_note", "hdl_assay_note", "hdl_result_note", 
            "hdl_plate", "hdl_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct HDL cholesterol analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent HDL cholesterol analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
hdl_var_table <- hdl_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(hdl_var_table)

```




#### Descriptive Statistics

Descriptive statistics are presented below for key HDL variables.

**Raw HDL cholesterol values:** 

```{r hdl-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
hdl_sum_df <- dbs_hdl_df %>% 
  select(hdl_direct, hdl_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% # warning due to <10 response
  calc_cont_sum_stats()

#create gt table
hdl_sum_tbl <- hdl_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
hdl_sum_tbl

```


**Data collection notes:** 

```{r hdl-cat-summary-table, results = 'asis'}

#notes for hdl_df
hdl_notes <- c(1, 4, 5, 37, 42)

hdl_note_df <- dbs_hdl_df %>% 
  select(ends_with("note"))

#apply function to each note column
hdl_note_list <- lapply(hdl_note_df, function(column) calc_multi_column(column, hdl_notes))

#combine results into df
hdl_note_sum <- bind_rows(hdl_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
hdl_tbl_notes <- hdl_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_4 = "N",
             Count_5 = "N",
             Count_37 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_37 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100))%>%
  cols_align(columns = c("Count_1", "Count_4", "Count_5", "Count_37", "Count_42", "Percent_1",
                         "Percent_4", "Percent_5", "Percent_37", "Percent_42", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Did not elute", columns = c(Count_37, Percent_37)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_4, Percent_4,
                                                        Count_5, Percent_5, Count_37, Percent_37,
                                                        Count_42, Percent_42))) 

# Render the table
print(hdl_tbl_notes) 



```


### Triglycerides (TRG) Description

These data include variables related to the triglycerides assessment, including direct and plasma equivalent (PE) triglyceride values for participants. Higher values indicate higher triglycerides. The PE triglyceride values should be used to calculate allostatic load indicators.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

TRG is measured in mg/dL.


#### Value Labels

The value labels for all `_note` variables (`trg_punch_note`, `trg_assay_note`, and `trg_result_note`) are below: 

```{r trg-label-table, results = 'asis'}
#Same as CHO notes table
# Print the table
print(cho_label_table)

```



#### Variables

All TRG variables are presented in the following table.

```{r TRG-var-table, results = 'asis'}
#create table of info
trg_var_df <- data.frame(
  Variable = c("dbs_id", "family", "trg_direct", "trg_pe", "trg_punch_note", "trg_assay_note", "trg_result_note", 
            "trg_plate", "trg_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct triglycerides analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent triglycerides analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
trg_var_table <- trg_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(trg_var_table)

```


#### Descriptive Statistics

Descriptive statistics are presented below for key TRG variables.

**Raw triglyceride values:** 

```{r trg-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
trg_sum_df <- dbs_trg_df %>% 
  select(trg_direct, trg_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats()

#create gt table
trg_sum_tbl <- trg_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
trg_sum_tbl

```


**Data collection notes:** 

```{r trg-cat-summary-table, results = 'asis'}
#notes for trg_df
trg_notes <- c(1, 4, 5, 37, 42)

trg_note_df <- dbs_trg_df %>% 
  select(ends_with("note"))

#apply function to each note column
trg_note_list <- lapply(trg_note_df, function(column) calc_multi_column(column, trg_notes))

#combine results into df
trg_note_sum <- bind_rows(trg_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
trg_tbl_notes <- trg_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_4 = "N",
             Count_5 = "N",
             Count_37 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_37 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100))%>%
  cols_align(columns = c("Count_1", "Count_4", "Count_5", "Count_37", "Count_42", "Percent_1",
                         "Percent_4", "Percent_5", "Percent_37", "Percent_42", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Did not elute", columns = c(Count_37, Percent_37)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_4, Percent_4,
                                                        Count_5, Percent_5, Count_37, Percent_37,
                                                        Count_42, Percent_42))) 

# Render the table
print(trg_tbl_notes) 



```



### C-Reactive Protein (CRP) Description

These data include variables related to the c-reactive protein assessment, including direct and plasma equivalent (PE) c-reactive protein values for participants. Higher values indicate higher c-reactive protein. The PE value should be used to calculate allostatic load indicators.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

CRP is measured in mg/L.

#### Value Labels

The value labels for all `_note` variables (`crp_punch_note`, `crp_assay_note`, and `crp_result_note`) are below: 

```{r CRP-label-table, results = 'asis'}
crp_label_df <- data.frame(
  value = c("1", "3", "4", "5", "29", "42"),
  label = c("Blank punch",
            "Smeared Drops/ Inconsistent Absorption",
            "Small spot, <80%",
            "Non-circular dried blood spot",
            "Below lower limit of detection (LLoD)",
            "Blood from filter paper touched inside back cover")
) %>% 
  t() %>% 
  as.data.frame()

crp_label_df <- setNames(crp_label_df[-1, ], unlist(crp_label_df[1, ]))


#create table
crp_label_table <- crp_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(crp_label_table)

```



#### Variables

All CRP variables are presented in the following table.

```{r CRP-var-table, results = 'asis'}
#create table of info
crp_var_df <- data.frame(
  Variable = c("dbs_id", "family", "crp_direct", "crp_pe", "crp_punch_note", "crp_assay_note", "crp_result_note", 
            "crp_plate", "crp_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct c-reactive protein analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent c-reactive protein analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
crp_var_table <- crp_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(crp_var_table)

```



#### Descriptive Statistics

Descriptive statistics are presented below for key CRP variables.

**Raw c-reactive protein values:** 

```{r CRP-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
crp_sum_df <- dbs_crp_df %>% 
  select(crp_direct, crp_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% # warning due to <10 response
  calc_cont_sum_stats()

#create gt table
crp_sum_tbl <- crp_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
crp_sum_tbl

```


**Data collection notes:** 

```{r crp-cat-summary-table, results = 'asis'}
#notes for crp_df
crp_notes <- c(1, 3, 4, 5, 29, 42)

crp_note_df <- dbs_crp_df %>% 
  select(ends_with("note"))

#apply function to each note column
crp_note_list <- lapply(crp_note_df, function(column) calc_multi_column(column, crp_notes))

#combine results into df
crp_note_sum <- bind_rows(crp_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
crp_tbl_notes <- crp_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_3 = "N", 
             Count_4 = "N",
             Count_5 = "N",
             Count_29 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_3 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_29 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100)) %>%
  cols_align(columns = c("Count_1", "Count_3", "Count_4", "Count_5", "Count_29", "Count_42", "Percent_1", "Percent_3",
                         "Percent_4", "Percent_5", "Percent_29", "Percent_42", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Smeared drops",  columns =  c(Count_3, Percent_3)) %>% 
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Below limit", columns = c(Count_29, Percent_29)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_3, Percent_3,
                                                        Count_4, Percent_4, Count_5, Percent_5, 
                                                        Count_29, Percent_29, Count_42, Percent_42))) 

# Render the table
print(crp_tbl_notes) 


```


### Epstein-Barr virus (EBV) Description

These data include variables related to the Epstein-Barr virus assessment, including direct and plasma equivalent (PE) Epstein-Barr virus values for participants. Higher values indicate higher Epstein-Barr virus concentration in the blood. The PE Epstein-Barr virus value should be used to calculate allostatic load indicators.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

EBV is measured in IU/mL.

#### Value Labels

The value labels for all `_note` variables (`ebv_punch_note`, `ebv_assay_note`, and `ebv_result_note`) are below: 

```{r ebv-label-table, results = 'asis'}
#specify notes in EBV data
ebv_label_df <- data.frame(
  value = c("1", "3", "4", "5", "12", "13", "42"),
  label = c("Blank punch",
            "Smeared Drops/ Inconsistent Absorption",
            "Small spot, <80%",
            "Non-circular dried blood spot",
            "Drop outside printed circle",
            "No DBS remains",
            "Blood from filter paper touched inside back cover")
) %>% 
  t() %>% 
  as.data.frame()

ebv_label_df <- setNames(ebv_label_df[-1, ], unlist(ebv_label_df[1, ]))


#create table
ebv_label_table <- ebv_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(ebv_label_table)

```



#### Variables

All EBV variables are presented in the following table.

```{r EBV-var-table, results = 'asis'}
#create table of info
ebv_var_df <- data.frame(
  Variable = c("dbs_id", "family", "ebv_direct", "ebv_pe", "ebv_punch_note", "ebv_assay_note", "ebv_result_note", 
            "ebv_plate", "ebv_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct Epstein-Barr virus analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent Epstein-Barr virus analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
ebv_var_table <- ebv_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(ebv_var_table)

```



#### Descriptive Statistics

Descriptive statistics are presented below for key EBV variables.

**Raw Epstein-Barr virus values:** 

```{r ebv-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
ebv_sum_df <- dbs_ebv_df %>% 
  select(ebv_direct, ebv_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats()

#create gt table
ebv_sum_tbl <- ebv_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
ebv_sum_tbl

```


**Data collection notes:** 

```{r ebv-cat-summary-table, results = 'asis'}
#notes for ebv_df
ebv_notes <- c(1, 3, 4, 5, 12, 13, 42)

ebv_note_df <- dbs_ebv_df %>% 
  select(ends_with("note"))

#apply function to each note column
ebv_note_list <- lapply(ebv_note_df, function(column) calc_multi_column(column, ebv_notes))

#combine results into df
ebv_note_sum <- bind_rows(ebv_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
ebv_tbl_notes <- ebv_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_3 = "N",
             Count_4 = "N",
             Count_5 = "N",
             Count_12 = "N",
             Count_13 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_3 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_12 = "%",
             Percent_13 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100))%>%
  cols_align(columns = c("Count_1", "Count_3", "Count_4", "Count_5", "Count_12", "Count_13",
                         "Count_42", "Percent_1", "Percent_3", "Percent_4", "Percent_5",
                         "Percent_12", "Percent_13", "Percent_42", "Percent_-55"), 
             align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Smeared drop",  columns =  c(Count_3, Percent_3)) %>%
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Outside circle",  columns = c(Count_12, Percent_12)) %>% 
  tab_spanner(label = "No DBS remains", columns = c(Count_13, Percent_13)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_3, Percent_3,
                                                        Count_4, Percent_4, Count_5, Percent_5,
                                                        Count_12, Percent_12, Count_13, Percent_13,
                                                        Count_42, Percent_42))) 

# Render the table
print(ebv_tbl_notes) 



```


### Hemoglobin A1C (A1C) Description

These data include variables related to the hemoglobin A1C assessment. Hemoglobin A1c does not have a plasma equivalent because it is presented as a direct value of the % (of total hemoglobin) in the dried blood spot sample.


The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

A1c is measured in % of total hemoglobin.

#### Value Labels

The value labels for all `_note` variables (`a1c_punch_note`, `a1c_assay_note`, and `a1c_result_note`) are below: 

```{r a1c-label-table, results = 'asis'}
#specify notes
a1c_label_df <- data.frame(
  value = c("1", "3", "4", "5", "13", "37", "42"),
  label = c("Blank punch",
            "Smeared Drops/ Inconsistent Absorption",
            "Small spot, <80%",
            "Non-circular dried blood spot",
            "No DBS remains",
            "Punch did not elute",
            "Blood from filter paper touched inside back cover")
) %>% 
  t() %>% 
  as.data.frame()

a1c_label_df <- setNames(a1c_label_df[-1, ], unlist(a1c_label_df[1, ]))


#create table
a1c_label_table <- a1c_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(a1c_label_table)

```




#### Variables

All A1C variables are presented in the following table.

```{r a1c-var-table, results = 'asis'}
#create table of info
a1c_var_df <- data.frame(
  Variable = c("dbs_id", "family", "a1c_hb", "a1c_punch_note", "a1c_assay_note", "a1c_result_note", 
            "a1c_plate", "a1c_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Hemoglobin A1C analyte concentrate obtained from dried blood spot",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
a1c_var_table <- a1c_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(a1c_var_table)

```



#### Descriptive Statistics

Descriptive statistics are presented below for key A1C variables.

**Raw hemoglobin A1C values:** 

```{r A1C-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
a1c_sum_df <- dbs_a1c_df %>% 
  select(a1c_hb) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats()

#create gt table
a1c_sum_tbl <- a1c_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
a1c_sum_tbl

```

**Data collection notes:** 

```{r a1c-cat-summary-table, results = 'asis'}
#notes for a1c_df
a1c_notes <- c(1, 3, 4, 5, 29, 42)

a1c_note_df <- dbs_a1c_df %>% 
  select(ends_with("note"))

#apply function to each note column
a1c_note_list <- lapply(a1c_note_df, function(column) calc_multi_column(column, a1c_notes))

#combine results into df
a1c_note_sum <- bind_rows(a1c_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
a1c_tbl_notes <- a1c_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Count_3 = "N", 
             Count_4 = "N",
             Count_5 = "N",
             Count_29 = "N",
             Count_42 = "N",
             Percent_1 = "%",
             Percent_3 = "%",
             Percent_4 = "%",
             Percent_5 = "%",
             Percent_29 = "%",
             Percent_42 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100)) %>%
  cols_align(columns = c("Count_1", "Count_3", "Count_4", "Count_5", "Count_29", "Count_42", "Percent_1", "Percent_3",
                         "Percent_4", "Percent_5", "Percent_29", "Percent_42", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_spanner(label = "Smeared drops",  columns =  c(Count_3, Percent_3)) %>% 
  tab_spanner(label = "Small spot,",  columns =  c(Count_4, Percent_4)) %>% 
  tab_spanner(label = "Non-circular",  columns = c(Count_5, Percent_5)) %>% 
  tab_spanner(label = "Below limit", columns = c(Count_29, Percent_29)) %>% 
  tab_spanner(label = "Touched cover", columns = c(Count_42, Percent_42)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1, Count_3, Percent_3,
                                                        Count_4, Percent_4, Count_5, Percent_5, 
                                                        Count_29, Percent_29, Count_42, Percent_42))) 

# Render the table
print(a1c_tbl_notes) 


```



### Interleukin-6 (IL6) Description

These data include variables related to the Interleukin-6 assessment, including direct and plasma equivalent (PE) Interleukin-6 values for participants. Higher values indicate higher Interleukin-6. The PE value should be used to calculate allostatic load indicators.

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.

IL-6 is measured in pg/mL.


#### Value Labels

The value labels for all `_note` variables (`il6_punch_note`, `il6_assay_note`, and `il6_result_note`) are below: 

```{r il6-label-table, results = 'asis'}
il6_label_df <- data.frame(`1` = "Blank punch", check.names = FALSE)


#create table
il6_label_table <- il6_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(il6_label_table)

```



#### Variables

All IL6 variables are presented in the following table.

```{r IL6-var-table, results = 'asis'}
#create table of info
il6_var_df <- data.frame(
  Variable = c("dbs_id", "family", "il6_direct", "il6_pe", "il6_punch_note", "il6_assay_note", "il6_result_note", 
            "il6_plate", "il6_date"),
  Description = c("Unique ID for each assay",
            "Participant ID",
            "Direct Interleukin-6 analyte concentrate obtained from dried blood spot",
            "Plasma-equivalent Interleukin-6 analyte concentration",
            "Note made by technician during sample preparation (punching)",
            "Note made by technician during assay",
            "Note indicating reportability of values",
            "ID for the plate used during assay",
            "Date of assay")) %>% 
  mutate(Notes = ifelse(grepl("_note", Variable), "When multiple notes were provided, they are separated by a semi-colon", ""))

#create gt table
il6_var_table <- il6_var_df %>%
  gt() %>% 
apply_tbl_theme() %>% 
  cols_width(Description ~ px(300),
             Variable ~ px(100)
             ) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print table
print(il6_var_table)

```




#### Descriptive Statistics

Descriptive statistics are presented below for key IL6 variables.

Raw Interleukin-6 values: 

```{r IL6-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats
il6_sum_df <- dbs_il6_df %>% 
  select(il6_direct, il6_pe) %>% 
  mutate_all(~ifelse(. == -99, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats()

#create gt table
il6_sum_tbl <- il6_sum_df  %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
il6_sum_tbl

```


**Data collection notes:** 

```{r il6-cat-summary-table, results = 'asis'}
#notes for il6_df
il6_notes <- c(1)

il6_note_df <- dbs_il6_df %>% 
  select(ends_with("note"))

#apply function to each note column
il6_note_list <- lapply(il6_note_df, function(column) calc_multi_column(column, il6_notes))

#combine results into df
il6_note_sum <- bind_rows(il6_note_list, .id = "Variable") %>% 
  pivot_wider(names_from = Response, values_from = c(Count, Percent)) %>% 
  mutate(across(starts_with("Percent"), ~ paste0(.x, "%"))) %>% 
  select(-`Count_-55`)

#create gt table
il6_tbl_notes <- il6_note_sum %>%
  gt() %>%
  cols_label(Count_1 = "N",
             Percent_1 = "%",
             `Percent_-55` = "% NA*") %>% 
  tab_options(table.width = pct(100)) %>%
  cols_align(columns = c("Count_1", "Percent_1", "Percent_-55"), align = "center") %>% 
  tab_spanner(label = "Blank punch",  columns =  c(Count_1, Percent_1)) %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  tab_footnote(footnote = "*NA = Not Applicable") %>%
  tab_options(table.border.bottom.style = "hidden") %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(Count_1, Percent_1))) 

# Render the table
print(il6_tbl_notes) 


```

# Other Health Measurements and Data 

These data are in the `bio_archive_NIJ.csv` file. Participant ID corresponds to the `id` variable, which can be used to merge additional data files from this study. 

Please note that participants who were incarcerated were only asked a subset of these questions. Additionally, they did not provide blood samples or participate in any other data collection activities that would require special equipment. 

The original survey included exact dates/times and confidential health information. To protect participant confidentiality, exact dates/times were transformed into approximate time elapsed since date/time. Confidential health information was removed from this data file. 

### Blood Pressure (BP) Description

These data include variables on systolic and diastolic blood pressure collected from participants. Higher scores indicate higher blood pressure. 

The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.


#### Variables

All BP variables are presented in the following table: 

```{r bp-var-tbl, results = 'asis'}
#create table for bp vars
print(create_bio_var_tbl(bio_md, "bp"))
```

#### Composite Variables

For both systolic and diastolic blood pressure, an average value was computed. The average values should be used to compute allostatic load indicators.


```{r bp-comp-tbl, results = 'asis'}
#extract variables from metadata
bp_scale_vars <- bio_md %>% 
  filter(str_starts(Variable, "bp") & str_ends(Variable, "avg")) %>% 
  pull(Variable)

#create table of info for AL indicators
bp_scale_df <- data.frame(
  var_name = bp_scale_vars,
  scale = c("Average systolic blood pressure (2)",
            "Average diastolic blood pressure (2)",
            "Allostatic load indicator based on clinical cut-off for high systolic BP (1)",
            "Allostatic load indicator based on clinical cut-off for high diastolic BP (1)",
            "Allostatic load indicator based on top 25% of systolic BP values (1)",
            "Allostatic load indicator based on top 25% of diastolic BP values (1)"),
  scale_construction = c("mean(`bp1`, `bp3`)",
                         "mean(`bp2`, `bp4`)",
                         "`bp_sys_avg` > 139",
                         "`bp_dia_avg` > 89",
                         "Top 25% of observed `bp_sys_avg` values",
                         "Top 25% of observed `bp_dia_avg` values"),
  scale_range = c(" ", " ", "0-1", "0-1", "0-1", "0-1")) #MARIA ENTER POSSIBLE VALUES FOR BP AVERAGE or leave blank/NA

#create gt table
bp_scale_table <- bp_scale_df %>%
  gt() %>% 
  cols_align(columns = c("scale_range"), align = "center") %>% 
  cols_label(var_name = "Variable Name",
            scale = "Description (# of items)", 
            scale_construction = "Composite Construction",
            scale_range = "Range*") %>% 
  tab_footnote(footnote = "*Range of possible values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>% 
  fmt_markdown() %>% 
  #cols_width(scale_construction ~ pct(100)) %>% 
  apply_tbl_theme() 

#print table
print(bp_scale_table)
```

#### Descriptive Statistics

Descriptive statistics are presented below for BP variables.

**Continuous values:** 

```{r bp-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
bp_sum_tbl <- bio_df %>% 
  select(bp1, bp2, bp3, bp4, bp_sys_avg, bp_dia_avg) %>% 
  mutate_all(~ifelse(. == -99 | . == -55 , NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
bp_sum_tbl

```




### Body Mass Index (BMI) Description

These data include variables on body mass index (BMI), including weight and height collected from participants. Higher scores indicate higher BMI. 

Using BMI values, allostatic load indicators for high BMI may be computed. The missing data rule was not applied since all participants who were asked BMI questions had valid data. Missing data for each variable presented in the descriptive statistics table below corresponds to "Not Applicable" values (`-55`).

#### Variables

All BMI variables are presented in the following table: 

```{r bmi-var-tbl, results = 'asis'}
#create table for bmi vars
print(create_bio_var_tbl(bio_md, "bmi"))
```


#### Descriptive Statistics

Descriptive statistics are presented below for BMI variables.

**Continuous values:** 

```{r bmi-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
bmi_sum_tbl <- bio_df %>% 
  select(bmi1, bmi2, bmi_score) %>% 
  mutate_all(~ifelse(. == -99 | . == -55 , NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>%
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
bmi_sum_tbl

```


### Waist-to-Hip Ratio (WTH) Description

These data include variables on waist-to-hip ratio collected from participants. Higher scores may be indicative of greater unhealthy body weight and therefore higher cardiometabolic risk.

Using waist and hip measurements, waist-to-hip ratio was calculated and should be used to compute allostatic load indicators. The missing data rule was not applied since all participants who were asked WTH questions had valid data. Missing data for each variable presented in the descriptive statistics table below corresponds to "Not Applicable" values (`-55`).


#### Variables

All WTH variables are presented in the following table: 

```{r wth-var-tbl, results = 'asis'}
#create table for vars
print(create_bio_var_tbl(bio_md, "wth"))
```


#### Descriptive Statistics

Descriptive statistics are presented below for WTH variables.

**Continuous values:** 

```{r wth-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
wth_sum_tbl <- bio_df %>% 
  select(wth1, wth2, wth_ratio) %>% 
  mutate_all(~ifelse(. == -99 | . == -55 , NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>% 
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
wth_sum_tbl

```



### Peak Expiratory Flow (PEF) Description

These data include variables on peak expiratory flow collected from participants using a spirometer, including direct peak expiratory flow and forced expiratory volume measurements. Lower scores indicate poorer air flow and poorer respiratory performance indicative of worse lung health.

Using peak expiratory flow values, average peak expiratory flow was calculated. Allostatic load indicators for peak expiratory flow can be computed using the averages, using values at or below the bottom percentile or values below clinical ranges indicative of healthy peak expiratory flow. The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.


#### Variables

All PEF variables are presented in the following table: 

```{r pef-var-tbl, results = 'asis'}
#create table for vars
print(create_bio_var_tbl(bio_md, "pef"))
```


#### Descriptive Statistics

Descriptive statistics are presented below for PEF variables.

**Continuous values:** 

```{r pef-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
pef_sum_tbl <- bio_df %>% 
  select(pef1, pef2, pef3, pef4, pef5, pef6, pef_avg) %>% 
  mutate_all(~ifelse(. == -99 | . == -55 , NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>% 
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
pef_sum_tbl

```


### Pulse Reading (PULSE) Description

These data include variables on pulse readings collected from participants. Higher scores indicate increased resting pulse rate. 

Using pulse readings, average pulse rate was calculated. Allostatic load indicators for high pulse rate can be computed using the averafe pulse rate. The missing data rule was not applied since no variables were computed. Missing data for each variable is presented in the descriptive statistics table below.


#### Variables

All PULSE variables are presented in the following table: 

```{r pulse-var-tbl, results = 'asis'}
#create table for vars
print(create_bio_var_tbl(bio_md, "pulse"))
```


#### Descriptive Statistics

Descriptive statistics are presented below for PULSE variables.

**Continuous values:** 

```{r pulse-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
pulse_sum_tbl <- bio_df %>% 
  select(pulse1, pulse2, pulse_avg) %>% 
  mutate_all(~ifelse(. == -99 | . == -55 , NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>% 
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
pulse_sum_tbl

```


### RAND Health Survey, SF-36 (RHS) Description

The RAND Health Survey SF-36 (RHS) is designed to measure health concepts, such as limitations, well-being, and general health. 

For the present study, 12 out of the 36 items from the RHS were collected.

Item numbers in this data set may not match original item numbers from the RHS-SF36. See the following table for corresponding item numbers from the original RHS-SF36:

| Variable | Original Item |
|----------|-------------|
| rhs1     | Item 1      |
| rhs2     | Item 13     |
| rhs3     | Item 14     |
| rhs4     | Item 15     |
| rhs5     | Item 16     |
| rhs6     | Item 17     |
| rhs7     | Item 18     |
| rhs8     | Item 19     |
| rhs9     | Item 33     |
| rhs10    | Item 34     |
| rhs11    | Item 35     |
| rhs12    | Item 36     |

Raw RHS variables were recoded per the [RHS-SF36 scoring guide](https://www.rand.org/health-care/surveys_tools/mos/36-item-short-form/scoring.html). All recoded variables end with `_p` and range from 0 to 100. Higher scores indicate a more favorable health state. Recoded variables may be used to calculate subscales of interest. 

The missing data rule was not applied since all participants had less than 20% missing data. 

Reference: [@hays1993rand](https://pubmed.ncbi.nlm.nih.gov/8275167/)


#### Value labels

The value labels for `rhs1` are below:

```{r rhs-label-table, results = 'asis'}

rhs_label_df <- data.frame(
  value = c("1", "2", "3", "4", "5"),
  label = c("Excellent",
            "Very good",
            "Good",
            "Fair",
            "Poor")) %>% 
  t() %>% 
  as.data.frame()

rhs_label_df <- setNames(rhs_label_df[-1, ], unlist(rhs_label_df[1, ]))


#create table
rhs_label_table <- rhs_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(rhs_label_table)


```

Variables `rhs2`, `rhs3`, `rhs4`, `rhs5`, `rhs6`, `rhs7`, and `rhs8` are dichotomous:

```{r rhs-dichot-label, results = 'asis'}
# Print the dichot table
print(dichot_label_table)
```

The value labels for `rhs9`, `rhs10`, `rhs11`, and `rhs12` are as follows:

```{r rhs-labels2, results = 'asis'}
rhs_label_df <- data.frame(
  value = c("1", "2", "3", "4", "5"),
  label = c("Definitely true",
            "Mostly true",
            "Don't know",
            "Mostly false",
            "Definitely false")) %>% 
  t() %>% 
  as.data.frame()

rhs_label_df <- setNames(rhs_label_df[-1, ], unlist(rhs_label_df[1, ]))


#create table
rhs_label_table <- rhs_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(rhs_label_table)

```

#### Survey Items

All RHS survey items and recoded variables are presented in the following table: 
```{r rhs-var-tbl, results = 'asis'}
#create df of vars
rhs_var_md <- bio_md %>% 
  filter(str_starts(Variable, "rhs")) %>% 
  head(-3)

#create and format the table
rhs_var_table <- rhs_var_md %>%
  gt() %>%
  cols_width(
      Variable ~ pct(25),
      Description ~ pct(75)) %>% 
  apply_tbl_theme() %>%
  tab_row_group(label = "Recoded variables for computing subscales:", 
                rows = 13:24,
                id = "p_vars")  %>% 
    tab_row_group(label = "How true or false is each of the following statements for you.", 
                rows = 9:12,
                id = "gen_health")  %>% 
    tab_row_group(label = "During the past 4 weeks, have you had any of the following problems with your work or other regular daily activities as a result of any emotional problems (such as feeling depressed or anxious)?", 
                rows = 6:8,
                id = "emo_limit") %>%
  tab_row_group(label = "During the past 4 weeks, have you had any of the following problems with your work or other regular activities as a result of your physical health?", 
                rows = 2:5,
                id = "phys_limit") %>%
  tab_row_group(label = "", 
                rows = 1,
                id = "rhs1") %>% 
  tab_style(style = list(cell_fill(color = "#9BB6D1", alpha = 0.2),
                         cell_borders(sides = c("left", "right", "top", "bottom"))),
            locations = cells_row_groups(groups = c("phys_limit", "emo_limit", "gen_health", "rhs1", "p_vars"))) %>%
  tab_style(style = cell_text(align = "left"), locations = cells_column_labels())

#print
rhs_var_table

```



#### Descriptive Statistics

Descriptive statistics are presented below for all RHS variables.

**Non-binary variables:** 

```{r rhs-cont-summary-table, results = 'asis'}
#apply function to calculate summary stats and create gt table
rhs_sum_tbl <- bio_df %>% 
  select(rhs1, rhs9:rhs12_p) %>%
  mutate_all(~ifelse(. == -99 | . == -55 | . == -77, NA, as.numeric(.))) %>% 
  calc_cont_sum_stats() %>% 
  gt() %>%
  cols_label(Range = "Range*",
             Missing = "% Missing") %>% 
  cols_width(everything() ~ pct(100)) %>%
  cols_align(columns = c("Mean", "SD", "Range", "Missing"), align = "center") %>% 
  tab_footnote("*Range of data values") %>% 
  tab_options(table.border.bottom.style = "hidden") %>%
  apply_tbl_theme()

# Render the table
rhs_sum_tbl

```

**Binary variables:**

```{r rhs-dichot-summary-table, results = 'asis'}
#create df - apply function to calculate summary stats and create
rhs_dichot_df <- bio_df %>% 
  select(rhs2:rhs8) %>%
  mutate_all(~ifelse(. == -99 | . == -55| . == -77, NA, as.numeric(.))) %>% 
  calc_dichot_sum_stats()


#create table
rhs_tbl_dichot <- create_dichot_gt_table(rhs_dichot_df)

#print table
rhs_tbl_dichot

```



### COVID-19 Exposure and Vaccination (CEV) Description

The COVID-19 Exposure and Vaccination (CEV) is a self-report measure with 10 items assessing recent COVID-19 exposures, health behaviors, and vaccinations.

There were no subscales computed since the CEV is not a standardized measure with developed subscales but meant to assess COVID-19 exposure.  Similarly, no distributions or clinical categories are presented as no subscales were calculated. 

Reference: Unpublished measure developed for this study



#### Value labels

Variables `cev1` through `cev9` are dichotomous:

```{r cev-dichot-label, results = 'asis'}
# Print the dichot table
print(dichot_label_table)
```

Value labels for `cev10` are below:

```{r cev-label-table, results = 'asis'}
cev_label_df <- data.frame(
  value = c("1", "2", "3"),
  label = c("Johnson & Johnson",
            "Moderna",
            "Pfizer")) %>% 
  t() %>% 
  as.data.frame()

cev_label_df <- setNames(cev_label_df[-1, ], unlist(cev_label_df[1, ]))

#create table
cev_label_table <- cev_label_df %>%
  gt() %>% 
  tab_options(table.border.top.width = 1, table.border.bottom.width = 1,
              table.border.left.width = 1, table.border.right.width = 1) %>% 
  cols_width(everything() ~ pct(100)) %>% 
  apply_labtab_theme()

# Print the table
print(cev_label_table)


```

#### Survey Items

All CEV survey items are presented in the following table: 

```{r cev-var-tbl, results = 'asis'}
#create table for vars
print(create_bio_var_tbl(bio_md, "cev"))
```

#### Descriptive Statistics

Descriptive statistics are presented below for all CEV variables.

**Binary variables:** 

```{r cev-dichot-summary-table, results = 'asis'}
#create df - apply function to calculate summary stats and create
cev_dichot_df <- bio_df %>% 
  select(starts_with("cev")) %>%
  select(-cev10) %>% 
  mutate_all(~ifelse(. == -99 | . == -55| . == -77, NA, as.numeric(.))) %>% 
  calc_dichot_sum_stats()


#create table
cev_tbl_dichot <- create_dichot_gt_table(cev_dichot_df)

#print table
cev_tbl_dichot

```

**Categorical variables:**

```{r cev-cat-summary-table, results = 'asis'}
#create df - apply function to calculate summary stats and create
cev_cat_df <- bio_df %>% 
  select(cev10) %>%
  mutate_all(~ifelse(. == -99 | . == -55 | . == -77, NA, as.numeric(.))) %>% 
  count(cev10) %>% 
  mutate(percent = paste0(n / sum(n) * 100, "%")) %>% 
  pivot_wider(names_from = cev10,
              values_from = c(n, percent),
              names_prefix = "grp_",
              names_sep = "_") %>% 
  select(-n_grp_NA) %>% 
  mutate(Variable = "cev10") %>% 
  select(Variable, everything())


#create table
cev_c_table <- cev_cat_df %>%
    gt() %>%
    cols_label(n_grp_1 = "N",
               percent_grp_1 = "%",
               n_grp_2 = "N",
               percent_grp_2 = "%",
               n_grp_3 = "N",
               percent_grp_3 = "%",
               percent_grp_NA = "% Missing") %>%
    tab_options(table.width = pct(100)) %>%
    cols_align(columns = c(n_grp_1, n_grp_2, n_grp_3, percent_grp_1, percent_grp_2, percent_grp_3, percent_grp_NA), align = "center") %>%
    tab_spanner(label = "Johnson & Johnson", columns = c(n_grp_1, percent_grp_1)) %>%
    tab_spanner(label = "Moderna", columns = c(n_grp_2, percent_grp_2)) %>%
    tab_spanner(label = "Pfizer", columns = c(n_grp_3, percent_grp_3)) %>%
    tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_spanners()) %>% 
  apply_tbl_theme() %>% 
  tab_style(style = list(cell_fill(color = alpha("#246B69", 0.6))),
            locations = cells_column_labels(columns = c(n_grp_1, n_grp_2, n_grp_3, percent_grp_1, percent_grp_2, percent_grp_3,))) %>% 
  cols_width(Variable ~ pct(20),
             starts_with("n_") ~ pct(20),
             starts_with("percent_") ~ pct(20))

#print table
cev_c_table

```


### Health and Biological Confound (HBC) Description

The Health and Biological Confound (HBC) survey is a self-report measure designed to assess various health behaviors that could confound the biological data variables of interest.

There were no subscales computed since the HBC is not a standardized measure with developed subscales but meant to assess potential health confounds related to the biological variables. Further, no descriptive statistics, distributions, or clinical categories are presented since these are not key study variables and there are no calculated subscales. 

Note: There are many conditional questions in this data set, thus there are many "Not Applicable" responses (`-55`).

Reference: Unpublished measure developed for the current study


#### Value labels

Due to the quantity of HBC variables and different value labels, value labels are presented in the variable table below

#### Survey Items

All HBC survey items are presented in the following table. If the variable has value, labels those are presented in the last column, if there are no value labels the type of variable is listed. 

```{r hbc-var-tbl, results = 'asis'}
#create vector of dichotomous hbc vars
vec_hbc_dichot <- c("hbc2", "hbc3", "hbc4", "hbc5", "hbc6", "hbc7", "hbc7a", "hbc8",
                    "hbc8a", "hbc9", "hbc9a", "hbc10", "hbc10a", "hbc11", "hbc11a", 
                    "hbc12", "hbc13", "hbc14", "hbc15", "hbc16", "hbc17", "hbc17b",
                    "hbc18", "hbc18e")
#create df of vars
hbc_var_md <- bio_md %>% 
  filter(str_starts(Variable, "hbc")) %>% 
  mutate(Description = str_remove(Description, "^[0-9]+[a-zA-Z]?\\. "),
         var_info = case_when(Variable %in% c("hbc7b", "hbc9c", "hbc18a") ~ "Open Text Variable",
                              Variable %in% c("hbc1", "hbc7c", "hbc8b", "hbc9b",
                                              "hbc10b", "hbc11b", "hbc12b",
                                              "hbc12c", "hbc18b", "hbc18c", "hbc18f") ~ "Continuous Variable",
                              Variable %in% vec_hbc_dichot ~ "0 = No 
                                                             \n1 = Yes",
                              Variable %in% c("hbc12a", "hbc12d") ~ "1 = 1 cigarette 
                                                                  \n2 = 2-5 cigarettes
                                                                  \n3 = 1 pack
                                                                  \n4 = 2 packs",
                              Variable %in% c("hbc13a", "hbc14a", "hbc15a", "hbc16a") ~
                                            "1 = Never 
                                           \n2 = .5-1 hour/day
                                           \n3 = 1-5 hours/day
                                           \n4 = 5 or more hours/day",
                              Variable %in% c("hbc17a", "hbc17c") ~ 
                                             "1 = 0 cups or cans 
                                            \n2 = 1-3 cups or cans
                                            \n3 = 4-6 cups or cans
                                            \n4 = 7-9 cups or cans
                                            \n5 = 10 or more cups or cans",
                              Variable == "hbc18d" ~ "1 = Mild 
                                                     \n2 = Moderate
                                                     \n3 = Vigorous",
                              TRUE ~ ""))


#create and format the table
hbc_var_table <- hbc_var_md %>%
  gt() %>%
  cols_width(
      Variable ~ pct(25),
      Description ~ pct(50),
      var_info ~ pct(40)) %>% 
  cols_label(var_info = "Variable Type or Value Labels") %>% 
  apply_tbl_theme() %>%
  tab_style(style = cell_text(align = "left"), 
      locations = cells_column_labels()) %>% 
  fmt_markdown()


#print
hbc_var_table
```

### Chronic Health Conditions (CHC) Description

The Chronic Health Conditions (CHC) survey is a self-report measure designed to assess various health conditions that may be confounded with the biological data collected as part of this study. They may also be of interest as indicators of health. 

There were no subscales computed since the CHC is not a standardized measure with developed subscales but meant to assess potential health confounds related to the biological variables. Further, no descriptive statistics, distributions, or clinical categories are presented since these are not key study variables and there are no calculated subscales.

Note: There are many conditional questions in this data set, thus there are many "Not Applicable" responses (`-55`).

Reference: Unpublished measure developed for the current study


#### Value labels

All CHC variables are dichotomous.

```{r chc-dichot-label, results = 'asis'}
# Print the dichot table
print(dichot_label_table)
```


#### Survey Items

All CHC survey items are presented in the following table:

```{r chc-var-tbl, results = 'asis'}
#create df of vars
chc_var_md <- bio_md %>% 
  filter(str_starts(Variable, "chc")) %>% 
  mutate(Description = str_remove(Description, "^[0-9]+[a-zA-Z]?\\. "))

#create table for vars
print(create_bio_var_tbl(chc_var_md, "chc"))

```

# References 
